# https://github.com/cheat/cheatsheets
- name: mdadm
  keybinds:
  - name: "To create (initialize) a new array:"
    key: "mdadm --create /dev/md${M} "
  - name: "levels"
    key: "-level=raid5"
  - name: "devices"
    key: "-raid-devices=4 /dev/sd{a,b,c,d,e}${P}"
  - name: "To manually assemble (activate) an existing array:"
    key: "mdadm --assemble /dev/md${M} /dev/sd{a,b,c,d,e}${P}"
  - name: "To automatically assemble (activate) all existing arrays:"
    key: "mdadm --assemble --scan"
  - name: "To stop an assembled (active) array:"
    key: "mdadm --stop /dev/md${M}"
  - name: "To see array configuration:"
    key: "mdadm --query /dev/md${M}"
  - name: "To see array component configuration (dump superblock content):"
    key: "mdadm --query --examine /dev/sd${D}${P}"
  - name: "To see detailed array confiration/status:"
    key: "mdadm --detail /dev/md${M}"
  - name: "To save existing arrays configuration:"
    key: "mdadm --detail --scan > /etc/mdadm/mdadm.conf"
  - name: "To erase array component superblock:"
    key: "mdadm --zero-superblock /dev/sd${D}${P}"
  - name: "To manually mark a component as failed:"
    key: "mdadm --manage /dev/md${M} --fail /dev/sd${D}${P}"
  - name: "To remove a failed component:"
    key: "mdadm --manage /dev/md${M} --remove /dev/sd${D}${P}"
  - name: "To prepare (format) a new device to replace a failed one:"
    key: "sfdisk -d /dev/sd${D,sane} | sfdisk /dev/sd${D,new}"
  - name: "To add new component to an existing array:"
    key: "mdadm --manage /dev/md${M} --add /dev/sd${D,new}${P}"
  - name: "To see assembled (active) arrays status:"
    key: "cat /proc/mdstat"
  - name: "To rename a device:"
    key: "mdadm --assemble /dev/md${M} /dev/sd{a,b,c,d,e}${P} --name=${name}:${M} --update=name"
